openapi: 3.0.3
info:
  title: Cuidado De Mascota API
  version: v1

servers:
  - url: http://localhost:8080/api/v1
    description: Base URL for API

paths: {}

components:
  schemas:

    # ================== BASE ==================
    BaseDTO:
      type: object
      properties:
        id:
          type: integer
          format: int64

    AbstractDTO:
      allOf:
        - $ref: '#/components/schemas/BaseDTO'
        - type: object
          properties:
            createdAt:
              type: string
              format: date-time
            updatedAt:
              type: string
              format: date-time
            active:
              type: boolean

    BaseResult:
      type: object
      properties:
        totalCount:
          type: integer
          example: 25
        items:
          type: array
          items:
            $ref: '#/components/schemas/BaseDTO'

    # ================== ROLE ==================
    RoleRequestDTO:
      type: object
      properties:
        name:
          type: string
          maxLength: 10

    RoleResponseDTO:
      allOf:
        - $ref: '#/components/schemas/BaseDTO'
        - type: object
          properties:
            name:
              type: string

    RoleResult:
      allOf:
        - $ref: '#/components/schemas/BaseResult'
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/RoleResponseDTO'

    # ================== USER ==================
    UserRequestDTO:
      type: object
      properties:
        name:
          type: string
          maxLength: 60
        lastName:
          type: string
          maxLength: 60
        email:
          type: string
          format: email
          maxLength: 100
        password:
          type: string
          writeOnly: true
        phoneNumber:
          type: string
          pattern: '^[+]?[0-9]{9,13}$'
          example: '+595 985 123456'
          description: Debe contener entre 9 y 13 dígitos numéricos.
        profilePhoto:
          type: string
        roleId:
          type: integer
          format: int64
        availabilityState:
          type: string
          enum: [ AVAILABLE, NOT_AVAILABLE, BUSY ]

    UserResponseDTO:
      allOf:
        - $ref: '#/components/schemas/AbstractDTO'
        - type: object
          properties:
            name:
              type: string
            lastName:
              type: string
            email:
              type: string
            phoneNumber:
              type: string
            profilePhoto:
              type: string
            roleId:
              type: integer
              format: int64
            availabilityState:
              type: string
              enum: [ AVAILABLE, NOT_AVAILABLE, BUSY ]

    UserResult:
      allOf:
        - $ref: '#/components/schemas/BaseResult'
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/UserResponseDTO'

    # ================== USER ROLE ==================
    UserRoleRequestDTO:
      type: object
      properties:
        userId:
          type: integer
          format: int64
          description: ID del usuario asociado al rol.
        roleId:
          type: integer
          format: int64
          description: ID del rol asignado al usuario.

    UserRoleResponseDTO:
      allOf:
        - $ref: '#/components/schemas/AbstractDTO'
        - type: object
          properties:
            userRoleId:
              type: integer
              format: int64
              description: ID del rol de usuario.
            userId:
              type: integer
              format: int64
              description: ID del usuario asociado.
            roleId:
              type: integer
              format: int64
              description: ID del rol asociado.

    UserRoleResult:
      allOf:
        - $ref: '#/components/schemas/BaseResult'
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/UserRoleResponseDTO'

    # ================== SERVICE TYPE ==================
    ServiceTypeRequestDTO:
      type: object
      properties:
        name:
          type: string
          maxLength: 100

    ServiceTypeResponseDTO:
      allOf:
        - $ref: '#/components/schemas/BaseDTO'
        - type: object
          properties:
            name:
              type: string

    ServiceTypeResult:
      allOf:
        - $ref: '#/components/schemas/BaseResult'
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/ServiceTypeResponseDTO'

    # ================== SERVICE ==================
    ServiceRequestDTO:
      type: object
      properties:
        carerId:
          type: integer
          format: int64
        serviceTypeId:
          type: integer
          format: int64
        description:
          type: string
        price:
          type: number
          format: double

    ServiceResponseDTO:
      allOf:
        - $ref: '#/components/schemas/AbstractDTO'
        - type: object
          properties:
            carerId:
              type: integer
              format: int64
            serviceTypeId:
              type: integer
              format: int64
            description:
              type: string
            price:
              type: number
              format: double

    ServiceResult:
      allOf:
        - $ref: '#/components/schemas/BaseResult'
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/ServiceResponseDTO'

    # ================== RESERVATION ==================
    ReservationRequestDTO:
      type: object
      properties:
        ownerId:
          type: integer
          format: int64
        carerId:
          type: integer
          format: int64
        serviceDate:
          type: string
          format: date-time
        reservationState:
          type: string
          enum: [PENDING, ACCEPTED, REJECTED, FINISHED, PAID]

    ReservationResponseDTO:
      allOf:
        - $ref: '#/components/schemas/AbstractDTO'
        - type: object
          properties:
            ownerId:
              type: integer
              format: int64
            carerId:
              type: integer
              format: int64
            serviceDate:
              type: string
              format: date-time
            reservationState:
              type: string
              enum: [PENDING, ACCEPTED, REJECTED, FINISHED, PAID]

    ReservationResult:
      allOf:
        - $ref: '#/components/schemas/BaseResult'
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/ReservationResponseDTO'

    # ================== RESERVATION SERVICE ==================
    ReservationServiceRequestDTO:
      type: object
      properties:
        reservationId:
          type: integer
          format: int64
        serviceId:
          type: integer
          format: int64

    ReservationServiceResponseDTO:
      allOf:
        - $ref: '#/components/schemas/AbstractDTO'
        - type: object
          properties:
            reservationId:
              type: integer
              format: int64
            serviceId:
              type: integer
              format: int64

    ReservationServiceResult:
      allOf:
        - $ref: '#/components/schemas/BaseResult'
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/ReservationServiceResponseDTO'

    # ================== INVOICE ==================
    InvoiceRequestDTO:
      type: object
      properties:
        reservationId:
          type: integer
          format: int64
        issueDate:
          type: string
          format: date-time
        totalAmount:
          type: number
          format: double

    InvoiceResponseDTO:
      allOf:
        - $ref: '#/components/schemas/AbstractDTO'
        - type: object
          properties:
            reservationId:
              type: integer
              format: int64
            issueDate:
              type: string
              format: date-time
            totalAmount:
              type: number
              format: double

    InvoiceResult:
      allOf:
        - $ref: '#/components/schemas/BaseResult'
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/InvoiceResponseDTO'

    # ================== PAYMENT METHOD ==================
    PaymentMethodRequestDTO:
      type: object
      properties:
        name:
          type: string
          maxLength: 60

    PaymentMethodResponseDTO:
      allOf:
        - $ref: '#/components/schemas/BaseDTO'
        - type: object
          properties:
            name:
              type: string

    PaymentMethodResult:
      allOf:
        - $ref: '#/components/schemas/BaseResult'
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/PaymentMethodResponseDTO'

    # ================== PAYMENT DETAIL ==================
    PaymentDetailRequestDTO:
      type: object
      properties:
        invoiceId:
          type: integer
          format: int64
        paymentMethodId:
          type: integer
          format: int64
        appliedAmount:
          type: number
          format: double

    PaymentDetailResponseDTO:
      allOf:
        - $ref: '#/components/schemas/AbstractDTO'
        - type: object
          properties:
            invoiceId:
              type: integer
              format: int64
            paymentMethodId:
              type: integer
              format: int64
            appliedAmount:
              type: number
              format: double

    PaymentDetailResult:
      allOf:
        - $ref: '#/components/schemas/BaseResult'
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/PaymentDetailResponseDTO'
